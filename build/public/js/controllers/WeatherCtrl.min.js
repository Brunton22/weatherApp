angular.module("WeatherCtrl",[]).controller("WeatherController",["$scope","$interval","Weather",function(a,b,c){function d(b){a.geolocation_error=!0,1==b?a.geolocation_error_text="There has been an error with the Geolocation Service":0==b&&(a.geolocation_error_text="Your browser is not compatible with Geolocation Services")}a.get_time=function(){c.get_time(a.time_unix,a.lat,a.lng).then(function(b){function c(){1==a.minutes.toString().length&&(a.minutes="0"+a.minutes)}function d(){a.clock_started=!0,setTimeout(function(){a.$apply(function(){a.seconds++,a.seconds<60?d():(a.seconds=(new Date).getSeconds(),a.minutes++,a.minutes<60?(c(),d()):(a.minutes=0,c(),a.hours++,a.hours<24?d():(a.hours=0,d())))})},1e3)}a.location_unix_time=a.time_unix+b.data.dstOffset+b.data.rawOffset,a.location_unix_date=new Date(1e3*a.location_unix_time),a.seconds=a.location_unix_date.getSeconds(),a.minutes=a.location_unix_date.getMinutes(),a.hours=a.location_unix_date.getHours(),c(),0==a.clock_started&&d()},function(a){console.log("Error")})},a.get_curr_time=function(){var b=new Date,c=b.getTime();return a.unix_time=c/1e3,a.unix_time},a.clock_started=!1,a.weather_called=!0,a.no_location_error=!1,a.geolocation_error=!1,a.input=document.getElementById("get-location-form"),a.autocomplete=new google.maps.places.Autocomplete(a.input),a.get_location=function(){a.autocomplete.getPlace()?(a.no_location_error=!1,a.geolocation_error=!1,a.lat=a.autocomplete.getPlace().geometry.location.lat(),a.lng=a.autocomplete.getPlace().geometry.location.lng(),a.time_unix=a.get_curr_time(),a.get_time(),c.get(a.lat,a.lng).then(function(b){a.temp=b.data.main.temp,a.rnd_temp=Math.round(a.temp),a.weather=b.data,a.weather_icon=a.weather.weather[0].icon,a.weather_called=!1,"01d"==a.weather_icon||"02d"==a.weather_icon||"03d"==a.weather_icon?a.weather_bg="day-bg":"04d"==a.weather_icon||"09d"==a.weather_icon||"10d"==a.weather_icon||"11d"==a.weather_icon||"13d"==a.weather_icon||"50d"==a.weather_icon?a.weather_bg="dull-bg":a.weather_bg="night-bg"},function(a){console.log("Error")})):a.no_location_error=!0},a.get_curr_location=function(){a.no_location_error=!1,a.geolocation_error=!0,navigator.geolocation?navigator.geolocation.getCurrentPosition(function(b){a.lat=b.coords.latitude,a.lng=b.coords.longitude,a.time_unix=a.get_curr_time(),a.get_time(),c.get(a.lat,a.lng).then(function(b){a.temp=b.data.main.temp,a.rnd_temp=Math.round(a.temp),a.weather=b.data,a.weather_icon=a.weather.weather[0].icon,a.weather_called=!1,a.location_text=b.data.name,"01d"==a.weather_icon||"02d"==a.weather_icon||"03d"==a.weather_icon?a.weather_bg="day-bg":"04d"==a.weather_icon||"09d"==a.weather_icon||"10d"==a.weather_icon||"11d"==a.weather_icon||"13d"==a.weather_icon||"50d"==a.weather_icon?a.weather_bg="dull-bg":a.weather_bg="night-bg"},function(a){console.log("Error")})},function(){d(!0)}):d(!1)},a.clear_form=function(){a.location_text="",0==a.weather_called&&(a.autocomplete=new google.maps.places.Autocomplete(a.input))}}]);